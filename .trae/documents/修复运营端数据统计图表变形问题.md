## 问题分析

从提供的图片可以看出，运营端数据统计的图表出现了变形：

1. **饼图（类型分布）变形**：原本应该是圆形的饼图变成了椭圆形
2. **柱状图显示异常**：网格线显示不完整，布局不协调

## 问题原因

经过检查，发现图表变形的主要原因是：

1. **缺少`maintainAspectRatio`配置**：Chart.js默认会根据容器大小自动调整宽高比，导致饼图变形
2. **图表容器样式问题**：容器的宽高设置可能导致图表比例失调
3. **响应式配置不完整**：缺少适当的响应式设置

## 修复方案

修改`admin.html`文件中的图表配置函数，为Chart.js添加正确的配置选项：

### 1. 修复饼图变形

在`updatePieChart`函数中，添加以下配置：
- `maintainAspectRatio: true` - 保持图表的宽高比
- `aspectRatio: 1` - 设置为1:1的宽高比，确保饼图是圆形

### 2. 优化柱状图显示

在`updateBarChart`函数中，添加以下配置：
- `maintainAspectRatio: true` - 保持图表的宽高比
- 调整网格线和刻度配置

## 修复后的代码

### 1. 修复后的`updatePieChart`函数

```javascript
// 更新饼图
function updatePieChart(typeDistribution) {
    const ctx = pieChartCanvas.getContext('2d');
    
    // 销毁之前的图表
    if (window.pieChart) {
        window.pieChart.destroy();
    }
    
    // 转换数据格式，只显示前5种
    const sortedTypes = Object.entries(typeDistribution)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
    
    const labels = sortedTypes.map(item => item[0]);
    const data = sortedTypes.map(item => item[1]);
    
    // 创建新图表
    window.pieChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: data,
                backgroundColor: [
                    '#4A90E2',
                    '#27AE60',
                    '#F39C12',
                    '#E74C3C',
                    '#9B59B6'
                ],
                borderColor: '#fff',
                borderWidth: 2
            }]
        },
        options: {
            maintainAspectRatio: true,
            aspectRatio: 1, // 保持1:1的宽高比，确保饼图是圆形
            plugins: {
                legend: {
                    position: 'bottom'
                },
                title: {
                    display: true,
                    text: '类型分布'
                }
            }
        }
    });
}
```

### 2. 修复后的`updateBarChart`函数

```javascript
// 更新柱状图
function updateBarChart(avgScores) {
    const ctx = barChartCanvas.getContext('2d');
    
    // 销毁之前的图表
    if (window.barChart) {
        window.barChart.destroy();
    }
    
    // 创建新图表
    window.barChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['亲密关系与边界建立', '心力管理', '自我认知与内在成长', '职业与价值实现'],
            datasets: [{
                label: '平均得分',
                data: [avgScores.dim1, avgScores.dim2, avgScores.dim3, avgScores.dim4],
                backgroundColor: '#4A90E2',
                borderColor: '#357ABD',
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: true,
            aspectRatio: 2, // 设置合适的宽高比
            scales: {
                y: {
                    beginAtZero: true,
                    max: 30,
                    grid: {
                        display: true,
                        color: 'rgba(0, 0, 0, 0.1)'
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: '维度平均得分'
                }
            }
        }
    });
}
```

## 修复效果

1. **饼图恢复圆形**：通过设置`aspectRatio: 1`，确保饼图保持1:1的宽高比
2. **柱状图布局优化**：调整了宽高比和网格线设置，使图表显示更协调
3. **响应式效果改善**：保持了图表的响应式特性，同时避免变形

## 验证方法

1. 打开运营端管理页面
2. 进入数据统计页面
3. 查看类型分布饼图是否恢复为圆形
4. 检查维度平均得分柱状图是否显示正常
5. 调整浏览器窗口大小，验证图表是否能正确响应

修复完成后，数据统计页面的图表将恢复正常显示，不再出现变形问题。